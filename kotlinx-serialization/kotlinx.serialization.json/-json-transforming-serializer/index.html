<HTML>
<HEAD>
<meta charset="UTF-8">
<title>kotlinx.serialization.json.JsonTransformingSerializer - kotlinx-serialization</title>
<link rel="stylesheet" href="../../../style.css">
</HEAD>
<BODY>
<a href="../../index.html">kotlinx-serialization</a>&nbsp;/&nbsp;<a href="../index.html">kotlinx.serialization.json</a>&nbsp;/&nbsp;<a href="./index.html">JsonTransformingSerializer</a><br/>
<br/>
<h1>JsonTransformingSerializer</h1>
<a name="kotlinx.serialization.json.JsonTransformingSerializer"></a>
(common, js, jvm, native) <code><span class="keyword">abstract</span> <span class="keyword">class </span><span class="identifier">JsonTransformingSerializer</span><span class="symbol">&lt;</span><span class="identifier">T</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/index.html"><span class="identifier">Any</span></a><span class="symbol">&gt;</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="../../kotlinx.serialization/-k-serializer/index.html"><span class="identifier">KSerializer</span></a><span class="symbol">&lt;</span><span class="identifier">T</span><span class="symbol">&gt;</span></code>
<p>Base class for custom serializers that allows manipulating an abstract JSON
representation of the class before serialization or deserialization.</p>
<p><a href="index.html#kotlinx.serialization.json.JsonTransformingSerializer">JsonTransformingSerializer</a> provides capabilities to manipulate <a href="../-json-element/index.html#kotlinx.serialization.json.JsonElement">JsonElement</a> representation
directly instead of interacting with <a href="../../kotlinx.serialization/-encoder/index.html#kotlinx.serialization.Encoder">Encoder</a> and <a href="../../kotlinx.serialization/-decoder/index.html#kotlinx.serialization.Decoder">Decoder</a> in order to apply a custom
transformation to the JSON.
Please note that this class expects that <a href="../../kotlinx.serialization/-encoder/index.html#kotlinx.serialization.Encoder">Encoder</a> and <a href="../../kotlinx.serialization/-decoder/index.html#kotlinx.serialization.Decoder">Decoder</a> are implemented by <a href="../-json-input/index.html#kotlinx.serialization.json.JsonInput">JsonInput</a> and <a href="../-json-output/index.html#kotlinx.serialization.json.JsonOutput">JsonOutput</a>,
i.e. serializers derived from this class work only with <a href="../-json/index.html#kotlinx.serialization.json.Json">Json</a> format.</p>
<p>During serialization, this class first serializes original value with <a href="#">tSerializer</a> to a <a href="../-json-element/index.html#kotlinx.serialization.json.JsonElement">JsonElement</a>,
then calls <a href="write-transform.html#kotlinx.serialization.json.JsonTransformingSerializer$writeTransform(kotlinx.serialization.json.JsonElement)">writeTransform</a> method, which may contain a user-defined transformation, such as
wrapping a value into <a href="../-json-array/index.html#kotlinx.serialization.json.JsonArray">JsonArray</a>, filtering keys, adding keys, etc.</p>
<p>During deserialization, the opposite process happens: first, value from JSON stream is read
to a <a href="../-json-element/index.html#kotlinx.serialization.json.JsonElement">JsonElement</a>, second, user transformation in <a href="read-transform.html#kotlinx.serialization.json.JsonTransformingSerializer$readTransform(kotlinx.serialization.json.JsonElement)">readTransform</a> is applied,
and then JSON tree is deserialized back to <a href="index.html#T">T</a> with <a href="#">tSerializer</a>.</p>
<p>Usage example:</p>
<pre><code>@Serializable
data class Example(
    @Serializable(UnwrappingJsonListSerializer::class) val data: String
)
// Unwraps a list to a single object
object UnwrappingJsonListSerializer :
    JsonTransformingSerializer&lt;String&gt;(String.serializer(), "UnwrappingList") {
    override fun readTransform(element: JsonElement): JsonElement {
        if (element !is JsonArray) return element
        require(element.size == 1) { "Array size must be equal to 1 to unwrap it" }
        return element.first()
    }
}
// Now these functions both yield correct result:
Json.parse(Example.serializer(), """{"data":["str1"]}""")
Json.parse(Example.serializer(), """{"data":"str1"}""")
</code></pre>
<h3>Parameters</h3>
<p><a name="T"></a>
<code>T</code> - A type for Kotlin property for which this serializer could be applied.
    <strong>Not</strong> the type that you may encounter in JSON. (e.g. if you unwrap a list
    to a single value <code>T</code>, use <code>T</code>, not <code>List&lt;T&gt;</code>)</p>
<p><a name="tSerializer"></a>
<code>tSerializer</code> - A serializer for type <a href="index.html#T">T</a>. Determines <a href="../-json-element/index.html#kotlinx.serialization.json.JsonElement">JsonElement</a> which is passed to <a href="write-transform.html#kotlinx.serialization.json.JsonTransformingSerializer$writeTransform(kotlinx.serialization.json.JsonElement)">writeTransform</a>.
    Should be able to parse <a href="../-json-element/index.html#kotlinx.serialization.json.JsonElement">JsonElement</a> from <a href="read-transform.html#kotlinx.serialization.json.JsonTransformingSerializer$readTransform(kotlinx.serialization.json.JsonElement)">readTransform</a> function.
    Usually, default serializer is sufficient.</p>
<p><a name="transformationName"></a>
<code>transformationName</code> - A name for the particular implementation to fulfill <a href="../../kotlinx.serialization/-serial-descriptor/serial-name.html#kotlinx.serialization.SerialDescriptor$serialName">SerialDescriptor.serialName</a> uniqueness guarantee.</p>
<h3>Constructors</h3>
<table>
<tbody>
<tr>
<td>
(common, js, jvm, native) 
<h4><a href="-init-.html">&lt;init&gt;</a></h4>
</td>
<td>
<p>Base class for custom serializers that allows manipulating an abstract JSON
representation of the class before serialization or deserialization.</p>
<code><span class="identifier">&lt;init&gt;</span><span class="symbol">(</span><span class="identifier" id="kotlinx.serialization.json.JsonTransformingSerializer$<init>(kotlinx.serialization.KSerializer((kotlinx.serialization.json.JsonTransformingSerializer.T)), kotlin.String)/tSerializer">tSerializer</span><span class="symbol">:</span>&nbsp;<a href="../../kotlinx.serialization/-k-serializer/index.html"><span class="identifier">KSerializer</span></a><span class="symbol">&lt;</span><span class="identifier">T</span><span class="symbol">&gt;</span><span class="symbol">, </span><span class="identifier" id="kotlinx.serialization.json.JsonTransformingSerializer$<init>(kotlinx.serialization.KSerializer((kotlinx.serialization.json.JsonTransformingSerializer.T)), kotlin.String)/transformationName">transformationName</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><span class="identifier">String</span></a><span class="symbol">)</span></code></td>
</tr>
</tbody>
</table>
<h3>Properties</h3>
<table>
<tbody>
<tr>
<td>
(common, js, jvm, native) 
<h4><a href="descriptor.html">descriptor</a></h4>
</td>
<td>
<p>A descriptor for this transformation.
By default, it uses the name composed of <a href="#">tSerializer</a>'s descriptor and transformation name,
kind of <a href="#">tSerializer</a>'s descriptor and contains 0 elements.</p>
<code><span class="keyword">open</span> <span class="keyword">val </span><span class="identifier">descriptor</span><span class="symbol">: </span><a href="../../kotlinx.serialization/-serial-descriptor/index.html"><span class="identifier">SerialDescriptor</span></a></code></td>
</tr>
</tbody>
</table>
<h3>Functions</h3>
<table>
<tbody>
<tr>
<td>
(common, js, jvm, native) 
<h4><a href="deserialize.html">deserialize</a></h4>
</td>
<td>
<p>Deserializes the value of type <a href="../../kotlinx.serialization/-deserialization-strategy/index.html#T">T</a> using the format that is represented by the given <a href="../../kotlinx.serialization/-deserialization-strategy/deserialize.html#kotlinx.serialization.DeserializationStrategy$deserialize(kotlinx.serialization.Decoder)/decoder">decoder</a>.
<a href="../../kotlinx.serialization/-deserialization-strategy/deserialize.html#kotlinx.serialization.DeserializationStrategy$deserialize(kotlinx.serialization.Decoder)">deserialize</a> method is format-agnostic and operates with a high-level structured <a href="../../kotlinx.serialization/-decoder/index.html#kotlinx.serialization.Decoder">Decoder</a> API.
As long as most of the formats imply an arbitrary order of properties, deserializer should be able
to decode these properties in an arbitrary order and in a format-agnostic way.
For that purposes, <a href="../../kotlinx.serialization/-composite-decoder/decode-element-index.html#kotlinx.serialization.CompositeDecoder$decodeElementIndex(kotlinx.serialization.SerialDescriptor)">CompositeDecoder.decodeElementIndex</a>-based loop is used: decoder firstly
signals property at which index it is ready to decode and then expects caller to decode
property with the given index.</p>
<code><span class="keyword">fun </span><span class="identifier">deserialize</span><span class="symbol">(</span><span class="identifier" id="kotlinx.serialization.json.JsonTransformingSerializer$deserialize(kotlinx.serialization.Decoder)/decoder">decoder</span><span class="symbol">:</span>&nbsp;<a href="../../kotlinx.serialization/-decoder/index.html"><span class="identifier">Decoder</span></a><span class="symbol">)</span><span class="symbol">: </span><span class="identifier">T</span></code></td>
</tr>
<tr>
<td>
(common, js, jvm, native) 
<h4><a href="read-transform.html">readTransform</a></h4>
</td>
<td>
<p>Transformation that happens during <a href="serialize.html#kotlinx.serialization.json.JsonTransformingSerializer$serialize(kotlinx.serialization.Encoder, kotlinx.serialization.json.JsonTransformingSerializer.T)">serialize</a> call.
Does nothing by default.</p>
<code><span class="keyword">open</span> <span class="keyword">fun </span><span class="identifier">readTransform</span><span class="symbol">(</span><span class="identifier" id="kotlinx.serialization.json.JsonTransformingSerializer$readTransform(kotlinx.serialization.json.JsonElement)/element">element</span><span class="symbol">:</span>&nbsp;<a href="../-json-element/index.html"><span class="identifier">JsonElement</span></a><span class="symbol">)</span><span class="symbol">: </span><a href="../-json-element/index.html"><span class="identifier">JsonElement</span></a></code></td>
</tr>
<tr>
<td>
(common, js, jvm, native) 
<h4><a href="serialize.html">serialize</a></h4>
</td>
<td>
<p>Serializes the <a href="../../kotlinx.serialization/-serialization-strategy/serialize.html#kotlinx.serialization.SerializationStrategy$serialize(kotlinx.serialization.Encoder, kotlinx.serialization.SerializationStrategy.T)/value">value</a> of type <a href="../../kotlinx.serialization/-serialization-strategy/index.html#T">T</a> using the format that is represented by the given <a href="../../kotlinx.serialization/-serialization-strategy/serialize.html#kotlinx.serialization.SerializationStrategy$serialize(kotlinx.serialization.Encoder, kotlinx.serialization.SerializationStrategy.T)/encoder">encoder</a>.
<a href="../../kotlinx.serialization/-serialization-strategy/serialize.html#kotlinx.serialization.SerializationStrategy$serialize(kotlinx.serialization.Encoder, kotlinx.serialization.SerializationStrategy.T)">serialize</a> method is format-agnostic and operates with a high-level structured <a href="../../kotlinx.serialization/-encoder/index.html#kotlinx.serialization.Encoder">Encoder</a> API.
Throws <a href="../../kotlinx.serialization/-serialization-exception/index.html#kotlinx.serialization.SerializationException">SerializationException</a> if value cannot be serialized.</p>
<code><span class="keyword">fun </span><span class="identifier">serialize</span><span class="symbol">(</span><span class="identifier" id="kotlinx.serialization.json.JsonTransformingSerializer$serialize(kotlinx.serialization.Encoder, kotlinx.serialization.json.JsonTransformingSerializer.T)/encoder">encoder</span><span class="symbol">:</span>&nbsp;<a href="../../kotlinx.serialization/-encoder/index.html"><span class="identifier">Encoder</span></a><span class="symbol">, </span><span class="identifier" id="kotlinx.serialization.json.JsonTransformingSerializer$serialize(kotlinx.serialization.Encoder, kotlinx.serialization.json.JsonTransformingSerializer.T)/value">value</span><span class="symbol">:</span>&nbsp;<span class="identifier">T</span><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></td>
</tr>
<tr>
<td>
(common, js, jvm, native) 
<h4><a href="write-transform.html">writeTransform</a></h4>
</td>
<td>
<p>Transformation that happens during <a href="deserialize.html#kotlinx.serialization.json.JsonTransformingSerializer$deserialize(kotlinx.serialization.Decoder)">deserialize</a> call.
Does nothing by default.</p>
<code><span class="keyword">open</span> <span class="keyword">fun </span><span class="identifier">writeTransform</span><span class="symbol">(</span><span class="identifier" id="kotlinx.serialization.json.JsonTransformingSerializer$writeTransform(kotlinx.serialization.json.JsonElement)/element">element</span><span class="symbol">:</span>&nbsp;<a href="../-json-element/index.html"><span class="identifier">JsonElement</span></a><span class="symbol">)</span><span class="symbol">: </span><a href="../-json-element/index.html"><span class="identifier">JsonElement</span></a></code></td>
</tr>
</tbody>
</table>
</BODY>
</HTML>

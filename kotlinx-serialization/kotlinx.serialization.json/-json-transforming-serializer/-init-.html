<HTML>
<HEAD>
<meta charset="UTF-8">
<title>kotlinx.serialization.json.JsonTransformingSerializer.<init> - kotlinx-serialization</title>
<link rel="stylesheet" href="../../../style.css">
</HEAD>
<BODY>
<a href="../../index.html">kotlinx-serialization</a>&nbsp;/&nbsp;<a href="../index.html">kotlinx.serialization.json</a>&nbsp;/&nbsp;<a href="index.html">JsonTransformingSerializer</a>&nbsp;/&nbsp;<a href="./-init-.html">&lt;init&gt;</a><br/>
<br/>
<h1>&lt;init&gt;</h1>
<a name="kotlinx.serialization.json.JsonTransformingSerializer$&lt;init&gt;(kotlinx.serialization.KSerializer((kotlinx.serialization.json.JsonTransformingSerializer.T)), kotlin.String)"></a>
(common, js, jvm, native) <code><span class="identifier">&lt;init&gt;</span><span class="symbol">(</span><span class="identifier" id="kotlinx.serialization.json.JsonTransformingSerializer$<init>(kotlinx.serialization.KSerializer((kotlinx.serialization.json.JsonTransformingSerializer.T)), kotlin.String)/tSerializer">tSerializer</span><span class="symbol">:</span>&nbsp;<a href="../../kotlinx.serialization/-k-serializer/index.html"><span class="identifier">KSerializer</span></a><span class="symbol">&lt;</span><span class="identifier">T</span><span class="symbol">&gt;</span><span class="symbol">, </span><span class="identifier" id="kotlinx.serialization.json.JsonTransformingSerializer$<init>(kotlinx.serialization.KSerializer((kotlinx.serialization.json.JsonTransformingSerializer.T)), kotlin.String)/transformationName">transformationName</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><span class="identifier">String</span></a><span class="symbol">)</span></code>
<p>Base class for custom serializers that allows manipulating an abstract JSON
representation of the class before serialization or deserialization.</p>
<p><a href="index.html#kotlinx.serialization.json.JsonTransformingSerializer">JsonTransformingSerializer</a> provides capabilities to manipulate <a href="../-json-element/index.html#kotlinx.serialization.json.JsonElement">JsonElement</a> representation
directly instead of interacting with <a href="../../kotlinx.serialization/-encoder/index.html#kotlinx.serialization.Encoder">Encoder</a> and <a href="../../kotlinx.serialization/-decoder/index.html#kotlinx.serialization.Decoder">Decoder</a> in order to apply a custom
transformation to the JSON.
Please note that this class expects that <a href="../../kotlinx.serialization/-encoder/index.html#kotlinx.serialization.Encoder">Encoder</a> and <a href="../../kotlinx.serialization/-decoder/index.html#kotlinx.serialization.Decoder">Decoder</a> are implemented by <a href="../-json-input/index.html#kotlinx.serialization.json.JsonInput">JsonInput</a> and <a href="../-json-output/index.html#kotlinx.serialization.json.JsonOutput">JsonOutput</a>,
i.e. serializers derived from this class work only with <a href="../-json/index.html#kotlinx.serialization.json.Json">Json</a> format.</p>
<p>During serialization, this class first serializes original value with <a href="#">tSerializer</a> to a <a href="../-json-element/index.html#kotlinx.serialization.json.JsonElement">JsonElement</a>,
then calls <a href="write-transform.html#kotlinx.serialization.json.JsonTransformingSerializer$writeTransform(kotlinx.serialization.json.JsonElement)">writeTransform</a> method, which may contain a user-defined transformation, such as
wrapping a value into <a href="../-json-array/index.html#kotlinx.serialization.json.JsonArray">JsonArray</a>, filtering keys, adding keys, etc.</p>
<p>During deserialization, the opposite process happens: first, value from JSON stream is read
to a <a href="../-json-element/index.html#kotlinx.serialization.json.JsonElement">JsonElement</a>, second, user transformation in <a href="read-transform.html#kotlinx.serialization.json.JsonTransformingSerializer$readTransform(kotlinx.serialization.json.JsonElement)">readTransform</a> is applied,
and then JSON tree is deserialized back to <a href="index.html#T">T</a> with <a href="#">tSerializer</a>.</p>
<p>Usage example:</p>
<pre><code>@Serializable
data class Example(
    @Serializable(UnwrappingJsonListSerializer::class) val data: String
)
// Unwraps a list to a single object
object UnwrappingJsonListSerializer :
    JsonTransformingSerializer&lt;String&gt;(String.serializer(), "UnwrappingList") {
    override fun readTransform(element: JsonElement): JsonElement {
        if (element !is JsonArray) return element
        require(element.size == 1) { "Array size must be equal to 1 to unwrap it" }
        return element.first()
    }
}
// Now these functions both yield correct result:
Json.parse(Example.serializer(), """{"data":["str1"]}""")
Json.parse(Example.serializer(), """{"data":"str1"}""")
</code></pre>
<h3>Parameters</h3>
<p><a name="T"></a>
<code>T</code> - A type for Kotlin property for which this serializer could be applied.
    <strong>Not</strong> the type that you may encounter in JSON. (e.g. if you unwrap a list
    to a single value <code>T</code>, use <code>T</code>, not <code>List&lt;T&gt;</code>)</p>
<p><a name="tSerializer"></a>
<code>tSerializer</code> - A serializer for type <a href="index.html#T">T</a>. Determines <a href="../-json-element/index.html#kotlinx.serialization.json.JsonElement">JsonElement</a> which is passed to <a href="write-transform.html#kotlinx.serialization.json.JsonTransformingSerializer$writeTransform(kotlinx.serialization.json.JsonElement)">writeTransform</a>.
    Should be able to parse <a href="../-json-element/index.html#kotlinx.serialization.json.JsonElement">JsonElement</a> from <a href="read-transform.html#kotlinx.serialization.json.JsonTransformingSerializer$readTransform(kotlinx.serialization.json.JsonElement)">readTransform</a> function.
    Usually, default serializer is sufficient.</p>
<p><a name="transformationName"></a>
<code>transformationName</code> - A name for the particular implementation to fulfill <a href="../../kotlinx.serialization/-serial-descriptor/serial-name.html#kotlinx.serialization.SerialDescriptor$serialName">SerialDescriptor.serialName</a> uniqueness guarantee.</p>
</BODY>
</HTML>
